# IPsec Capture Configuration
# Source this file or place in same directory as run-dual-capture.sh

# Node names
NODE1_NAME="worker1.example.com"
NODE2_NAME="worker2.example.com"

# Network interface to capture on
INTERFACE="br-ex"

# Capture duration in seconds
DURATION="30"

# Max packets to capture (stops early if reached)
PACKET_COUNT="1000"

# Ignore packet count, run tcpdump for full duration (true/false)
NO_PACKET_LIMIT="false"

# Local directory to save pcap files
# Note: On macOS, use ~/path (not /tmp) for Podman volume mounts
LOCAL_OUTPUT="${HOME}/ipsec-captures"

# tcpdump filter expression
# Use {NODE1_IP} and {NODE2_IP} as placeholders for node IPs
# Examples:
#   "host {NODE1_IP} and host {NODE2_IP} and esp"  - ESP traffic between nodes (default)
#   "host {NODE1_IP} and host {NODE2_IP}"          - All traffic between nodes
#   "esp"                                           - All ESP traffic
#   ""                                              - Capture everything
FILTER="host {NODE1_IP} and host {NODE2_IP} and esp"

# tcpdump extra options (added to tcpdump command)
# Examples:
#   "-v"      - Verbose output
#   "-e"      - Print link-level header
#   ""        - No extra options (default)
TCPDUMP_EXTRA=""

# ========== Retis Settings ==========

# Retis container image
RETIS_IMAGE="quay.io/retis/retis"

# Retis probe for kernel tracing
# Default: xfrm_audit_state_icvfail/stack - tracks IPsec ICV integrity failures
# For LOCAL TESTING (no real IPsec drops): use "net:netif_receive_skb"
#   This captures all received packets, useful for testing the correlation logic
# Examples:
#   "xfrm_audit_state_icvfail/stack"  - IPsec ICV failures (production, default)
#   "net:netif_receive_skb"           - All received packets (testing only)
RETIS_PROBE="xfrm_audit_state_icvfail/stack"

# Retis filter expression (empty = capture all drops)
# Examples:
#   "src host 192.168.1.1 and dst host 192.168.1.2"
#   ""  - Capture all drops (default)
RETIS_FILTER=""

